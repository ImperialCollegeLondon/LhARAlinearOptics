--------  --------  --------  --------  --------  --------  --------  27Dec23
Worked through quads, solenoid, and dipole.  Included longitudinal elements in
transfer matrices.  Think it works now.  Have, laser-driven source (Maria
original, wrong in detail), Gaussian, and flat.

To do:
 - Get rid of hard coded beam-pipe cut
 - Fix Dipole test spreadsheet and test in 02-Tests to meet coding;
 - Fix all tests to include longitudinal phase space
 - Fix parameters so that beam line can bend vertical (this is in rotation
   of reference frame)
 - Implement cavities
 - Slides for WP6

Probably more.

Studies:
 - Beam-pipe size, need to check GL size etc.
 - Switch solenoids for GLs.
 - Low energy cut off and peaks in delta distribution
 - Energy distribution study
 - Comparison with BDSIM
 - Focussing etc. for spot scanning
 
To check:
 - Fix description of transfer matrix for drift in w/u;
 - Add time (z) dependence to Drift transfer matrix in BeamLineElement.

Immiediate next step need to run through tests and scripts, as usual!

 - BeamLineTst.py          - OK after fix to solenoid initialisation.
 - BeamLineElementTst.py   - OK
 - DRACOfacilityTst.py     - OK
 - DefocusQuadTst.py       - Fails at line 113!  Reason is that transport didnt
                             work because input _R was outside (hard coded)
			     beam pile.  Fixed, but now it doesnt agree with
			     spreadsheet.  Need to fix spreadsheet to get this
			     consistent.
			     OK after fix.
 - DipoleTst.py            - OK
 - DriftTst.py             - OK
 - FocusQuadTst.py         - OK
 - GaborLensTst.py         - OK
 - LIONfacilityTst.py      - OK
 - LhARAFacilityTst.py     - OK
 - OctupoleTst.py          - Runs, but, reports difference with expected result
 - ParticleTst.py          - OK
 - PhysicalConstantsTst.py - OK
 - RFCavityTst.py          - Fails with "bad beamline element" interupt
 - ReferenceParticleTst.py - OK
 - RunSimulationTst.py     - OK
 - SimulationTst.py        - OK
 - SolenoidTst.py          - OK 
 - SourceTst.py            - OK 
 - TestRead.py             - OK
 - TestWrite.py            - OK

Run scripts:
 - RunDRACOsimulation.py   - OK
 - ReadDRACOsimu.py        - OK -- Runs OK, but, not sure I understand plots.
 - RunLIONsimulation.py    - OK -- Runtime warning in first event ... sqrt(k)
 - ReadLIONsimu.py         - Fails! only 4 plots, bad distributions.
 - RunLhARAsimulation.py   - OK
 - ReadLhARAsimu.py        - OK
 - plotTrajectory.py       - OK

--------  --------  --------  --------  --------  --------  --------  --------
